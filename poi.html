<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Destinations</title>

    <!-- Bootstrap style -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <!-- Jquery Core and other libraries -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <!-- JQuery Mobile -->
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>


    <!-- adding Firebase to the project -->
    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase.js"></script>


    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyCFehxZmR7Ml3f85kHhHlFrHQd0w19A46M",
            authDomain: "guidecph-1543331288734.firebaseapp.com",
            databaseURL: "https://guidecph-1543331288734.firebaseio.com",
            projectId: "guidecph-1543331288734",
            storageBucket: "guidecph-1543331288734.appspot.com",
            messagingSenderId: "1025601520459"
        };
        firebase.initializeApp(config);
    </script>

    <!-- Own styles -->
    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/style.css" />

    <!-- Own functions -->
    <script>
        $(document).ready(function() { //script starts working after all html is uploaded

            // calling DB
            var database = firebase.database();

            // reading from DB and setting into a list
            database.ref('places/').on('value', function(snapshot) {
                var statusHTML = '<ul data-role="listview" class="PoiList">';
                snapshot.forEach(function(childSnap) {
                    var id = childSnap.key;
                    var title = childSnap.child("title").val();
                    var infoShort = childSnap.child("info-short").val();
                    statusHTML += '<a href=\"#' + id + '\" class=""><li class="card-body">';
                    statusHTML += title;
                    statusHTML += "</br>";
                    statusHTML += infoShort;
                    statusHTML += '</li></a>';
                    console.log(statusHTML);
                    //rendering the keys and values

                }); // end of foreach
                statusHTML += '</ul>';
                $('#PoiList').html(statusHTML);
            }, function(error) {
                console.log("Error: " + error.code);
            }); //end read


            // start read - all info about POI
            database.ref('places/').on('value', function(snapshot) {
                var statusHTML = '<div class="poi row">';
                snapshot.forEach(function(childSnap) {
                    var id = childSnap.key;
                    var title = childSnap.child("title").val();
                    var infoShort = childSnap.child("info-short").val();
                    var infoFull = childSnap.child("info-full").val();
                    statusHTML += '<div class="media col-xs-6 mt-5" id=\"' + id + '\">';
                    statusHTML += '<div class="mr-3"><img class="rounded" src="https://placeimg.com/200/200/people" alt="Placeholder"></div>';
                    statusHTML += '<div data-role="header" class="media-body ui-content"><div class="media-title"><strong>' + title + '</strong></div>';
                    statusHTML += "</br>";
                    statusHTML += infoShort;
                    statusHTML += "</br>";
                    statusHTML += infoFull;
                    statusHTML += '</div></div>';
                }); // end of foreach
                statusHTML += '</div>'; //closing the loop's tag
                $('#allPois').html(statusHTML); // sending the html code to the page
            }, function(error) {
                console.log("Error: " + error.code);
            }); //end read
        }); //end ready
    </script>



</head>

<body>
    <div class="container">
        <div class="row">
            <div class="card" id="PoiList"></div>
        </div>
        <div class="row" id="allPois"></div>

    </div>
</body>

</html>